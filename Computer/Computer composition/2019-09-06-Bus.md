---
title: 6.1 总线概述
date: 2019-11-29
---

随着计算机的发展和应用领域的不断扩大，I/O 设备的种类和数量也越来越多。为了更好地解决 I/O 设备与主机之间连接的灵活性问题，计算机的结构从分散连接发展为总线连接。为了进一步简化设计，又提出各类总线标准。

## 1. 总线基本概念

### 1.1 总线的定义

总线是一组能为多个部件分时共享的公共信息传送线路。分时和共享是总线的两个特点。

分时是指同一时刻只允许有一个部件向总线发送信息，若系统中有多个部件，则它们只能分时地向总线发送信息。

共享是指总线上可以挂载多个部件，各个部件之间互相交换的信息都可通过这组线路分时共享。在某一时刻只允许有一个部件向总线发送信息，但多个部件可同时从总线上接收相同的信息。

### 1.2 总线设备

总线上所连接的设备，按其对总线有无控制功能可分为主设备和从设备两种。

主设备：总线的主设备是指获得总线控制权的设备。

从设备：总线的从设备是指被主设备访问的设备，它只能响应从主设备发来的各种总线命令。

### 1.3 总线特性

总线特性是指**机械特性**（尺寸、形状）、**电气特性**（传输方向和有效的电平范围）、**功能特性**（每根传输线的功能）和**时间特性**（信号和时序的关系）。

### 1.4 总线的猝发传输方式

在**一个总线周期**内传输存储地址连续的**多个数据字**的总线传输方式，称为猝发传送。

## 2. 总线的分类

计算机系统中的总线，按功能划分为以下 3 类。

### 2.1 片内总线

片内总线是芯片内部的总线，它是 CPU 芯片内部寄存器与寄存器之间、寄存器与 ALU 之间的公共连接线。

### 2.2 系统总线

系统总线是计算机系统内各功能部件（CPU、主存、I/O 接口）之间相互连接的总称。

按系统总线传输信息内容的不同，又可分为 3 类：数据总线、地址总线和控制总线。

1. 数据总线用来传输各功能部件之间的数据信息，它是**双向**传输总线，其位数与机器字长（CPU 处理一次的字长）、存储字长（内存储器字长）有关。
2. 地址总线用来指出数据总线上的源数据或目的数据所在的**主存单元**或 **I/O 端口**的地址，它是**单向**传输总线，地址总线的位数与**主存地址空间的大小**有关。
3. 控制总线传输的是**控制信息**，包括 CPU 送出的**控制命令**和主存（或外设）返回 CPU 的**反馈信号**。

注意区分**数据通路**和**数据总线**：各个功能部件通过数据总线连接形成的数据传输路径称为数据通路。数据通路表示的是**数据流经的路径**，而数据总线是**承载的媒介**。

### 2.3 通信总线

通信总线是在**计算机系统之间**或计算机系统与其他系统（如远程通信设备、测试设备）之间传送信息的总线，通信总线也称**外部总线**。

此外，按时序控制方式可将总线划分为**同步**和**异步**总线，还可按数据传输格式将总线划分为**并行总线**和**串行总线**。

## 3. 系统总线的结构

总线结构通常分为单总线结构、双总线结构和三总线结构等。

### 3.1 单总线结构

单总线结构将 CPU、主存、I/O 设备（通过 I/O 接口）都挂在一组总线上，运行 I/O 设备之间、**I/O 设备与主存之间直接交换信息**。**CPU 与主存**、**CPU 与外设之间可直接进行信息交换**，而无须经过中间设备的干预。（P245）

注意：单总线并不是指只有一根信号线，系统总线按传送信息的不同可细分为地址总线、数据总线和控制总线。

优点：结构简单，成本低，易于接入新的设备；缺点：带宽低、负载重，多个部件只能争用唯一的总线，且不支持并发传送操作。

### 3.2 双总线结构

双总线结构有两条总线：一条是**主存总线**。用于在 CPU、主存和通道之间传送数据；另一条是 **I/O 总线**，用于在多个外部设备与通道之间传送数据。（P245）

优点：将低速 I/O 设备从单总线上分离开来，实现了存储器总线和 I/O 总线分离。缺点：需要增加通道等硬件设备。

### 3.3 三总线结构

三总线结构是在计算机系统各部件之间采用 3 条各自独立的总线来构成信息通道，这 3 条总线分别为**主存总线**、**I/O 总线**和**直接内存访问**（DMA）总线。（P245）

主存总线用于在 CPU 和内存之间传送地址、数据和控制信息。I/O 总线用于在 CPU 和各类外设之间通信。DMA 总线用于在内存和高速外设之间直接传送数据。

优点：提高了 I/O 设备的性能，使其更快地响应命令，提高系统吞吐量。缺点：系统工作效率低。

## 4. 总线的性能指标

1. 总线的传输周期。指一次总线操作所需的时间（包括申请阶段、寻址阶段、传输阶段和结束阶段），简称**总线周期**。总线传输周期通常由**若干总线时钟周期**构成。

2. 总线时钟周期。即**机器的时钟周期**。计算机有一个统一的时钟，以控制整个计算机的各个部件，总线也要受此时钟的控制。

3. 总线的工作频率。总线上各种操作的频率，为**总线周期的倒数**。实际上指 **1 秒内传送几次数据**。若总线周期 = N 个时钟周期，则总线的工作频率 = 时钟频率/N 。

4. 总线的时钟频率。即机器的时钟频率，它为时钟周期的倒数。

5. 总线宽度。又称总线位宽，它是总线上同时能够传输的数据位数，通常指**数据总线的根数**，如 32 根称为 32 位总线。

6. 总线带宽。可理解为总线的数据传输率，即**单位时间内总线上可传输数据的位数**，通常用每秒传送信息的字节数来衡量，单位可用字节/秒（B/s）表示。总线带宽 = 总线工作频率×(总线宽度/8) 。

   注意：总线带宽和总线宽度应加以区别。

7. 总线复用。总线复用是指一种信号线在**不同的时间传输不同的信息**，因此可以使用较少的线传输更多的信息，从而节省空间和成本。

8. 信号线数。地址总线、数据总线和控制总线 3 种总线数的总和称为信号线数。其中，总线的最主要性能指标为总线宽度、总线（工作）频率、总线带宽，总线带宽是指总线本身所能达到的最高传输速率，它是衡量总线性能的重要指标。

   三者关系：总线带宽 = 总线宽度 × 总线频率。

   例如，总线工作频率为 22MHz，总线宽度为 16 位，则总线带宽 = 22×(16/8) = 44MB/s 。

## 1. 习题

1. 在系统总线的数据线上传输的信号包括？
2. 单周期处理器中所有指令的指令周期为一个时钟周期。这种结构有何特点？
3. 容量上的 1K 和 速率上的 IK 的区别
4. 关于总线设计的易错点
5. 多总线结构的特点

## 2. 习题答案

1. 指令和操作数其实都是存储在内存中的数据，都是数据线上传输的。中断类型号用以指出中断向量的地址，CPU 响应中断请求后，将中断应答信号（INTR）发回数据总线，CPU 从数据总线上读取中断类型号后，查找中断向量表，找到相应的中断处理程序入口。而握手（应答）数据通信联络信号，应在控制总线上传输。

2. 单周期处理器是指所有指令为一个时钟周期的处理器。因为每条指令的 CPI 为 1，要考虑比较慢的指令，所以处理器的时钟频率较慢。单周期处理器要求在一个时钟周期内完成一个指令，包括多个功能部件的功能的并行，所以不可能采用单总线结构。

3. 容量上 1K=2¹⁰，速率上的 IK=10³

4. 并行总线传输不一定比串行总线传输速度快，在实际时钟频率较低的情况下，并行总线因为可以同时传输若干比特，速率确实比串行总线快。但是，随着技术的发展，时钟频率越来越高，并行导线之间的相互干扰越来越严重，当时钟频率提高到一定程度时，传输的数据已经无法恢复。而串行总线因为导线少，线间干扰容易控制，反而可通过不断提高时钟频率来提高传输速率。

   总线复用是指一种信号线在不同的时间传输不同的信息，它可使用较少的线路传输更多的信息，从而节省空间和成本。

   突发（猝发）传输是指在一个总线周期中，可以传输多个存储地址连续的数据，即一次传输一个地址和一批地址连续的数据。

   分离事务通信是总线复用的一种，相比单一的传输路线可以提高总线的利用率。

5. 多总线结构用速率高的总线连接高速设备，用速率低的总线连接低速设备。一般来说，CPU 是计算机的核心，是计算机中速度最快的设备之一。

   突发传送方式把多个数据单元作为一个独立传输处理，从而最大化设备的吞吐量。现实中一般用支持突发传送方式的总线来提高存储器的读写效率。

   各总线通过桥接器相连，后者起流量交换作用。

   PCI-Express 总线都采用串行数据包传输数据。

