---
title: 2.1 数制与编码
date: 2019-11-06
---

## 1. 进位计数制及其相互转换

## 1.1 进位计数法

1. 二进制（0~1）
2. 八进制（0~7）
3. 十六进制（0~9~A~F）

### 1.2 不同进制数之间的相互转换

1. 二进制数转换为八进制数和十六进制数（三合一、四合一）
2. 任意进制数转换为十进制数（按权展开相加法）
3. 十进制数转换为任意进制数（带余除基法得到整数的逆序，乘基取整法得到小数的正序）

## 2. 真值和机器数

在日常生活中，通常用正号、负号来分别表示正数（正号可省略）和负数，如 +15，-8 等。这种带 `+` 或 `-` 符号的数称为真值。真值是机器数所代表的实际值。

在计算机中，通常采用数的符号和数值一起编码的方法来表示数据。常用的有原码、补码和反码表示法。这几种表示法都将数据的符号数字化，通常用 `0` 表示 “正”，用 `1` 表示 “负”。如 0,101（这里的逗号 `,` 实际上并不存在，仅为区分符号位与数值位）表示 +5。这种把符号 “数字化” 的数称为机器数。

## 3. BCD 码

二进制编码的十进制数（Binary-Coded Decimal，BCD）通常采用 4 位二进制数来表示一位十进制数中的 0~9 这 10 个数码

1. 8421 码（最常用）。它是一种有权码，设其各位的数值为 `b3,b2,b1,b0` ，则权值从高到低依次为 8，4，2，1，它表示的十进制数为 D=8b3+4b2+2b1+b0。如 8→1000；9→1001。

   若两个 8421 码相加之和大于 1001 时，则要加 6 修正（1010~1111 这 6 个为无效码，当运算结果落于这个区间时，需要将运算结果加上 6），并向高位进位，进位可以在首次相加或修正时产生。

2. 余 3 码。这是一种无权码，是在 8421 码的基础上加 (0011)₂ 形成的，因每个数都多余 `3` ，故称为余 3 码。如 8→1011；9→1100 。 

3. 2421 码。这也是一种有权码，权值由高到低分别为 2，4，2，1，特点是大于等于 5 的 4 位二进制数中最高位为 1，小于 5 的最高位为 0。如 5→1011 而非 0101 。

## 4. 字符与字符串

由于计算机内部只能识别和处理二进制代码，所以字符都必须按照一定的规则用一组二进制编码来表示。

### 4.1 字符编码 ASCII 码

目前，国际上普遍采用的一种字符系统是 7 位二进制编码的 ASCII 码，它可表示 10 个二进制数码、52 个英文大写字母和小写字母（A~Z，a~z）及一定数量的专用符号（如 $、%、+、= 等），共 128 个字符。

在 ASCII 码中，编码值 0~31 为控制字符，用于通信控制或设备的功能控制；编码值 127 是 DEL 码；编码值 32 是空格 SP；编码值 32~126 共 95 个字符称为可印刷字符。

```markdown
0~9 的 ASCII 码值为 48(011 0000)~57(011 1001) ，即去掉高 3 位，只保留低 4 位，
正好是二进制形式的 0~9
```

### 4.2 汉字的表示和编码

在 1981 年的国家标准 GB2312-1980 中，每个编码用两个字节表示，收录了一级汉字 3755 个、二级汉字 3008 个，各种符号 682 个，共计 7445 个。

目前最新的汉字编码是 2000 年公布的国家标准 GB 18030，它收录了 27484 个汉字。编码标准采用 1B，2B 和 4B。

汉字的编码包括汉字的输入编码、汉字内码、汉字字形码三种，它们是计算机中用于输入、内部处理和输出三种用途的编码。区位码是国家标准局于 1981 年颁布的标准，它用两个字节表示一个汉字，每个字节用七位码，并将汉字和图形符号排列在一个 94 行 94 列的二维代码表中。区位码是 4 位十进制数，前 2 位是区码，后 2 位是位码，所以称为区位码。

国标码将十进制的区位码转换为十六进制数后，再在每个字节上加上 20H。国标码两个字节的最高位都是 0，ASCII 码的最高位也是 0。为了方便计算机区分中文字符和英文字符，将国标码两个字节的最高位都改为 1，这就是汉字内码。

区位码和国标码都是输入码，它们和汉字内码的关系（十六进制）如下

```markdown
国标码 = (区位码)₁₆ + 2020H
汉字内码 = (国标码)₁₆ + 8080H
```

### 4.3 字符串的存放

字符串是指连续的一串字符，通常情况下，它们占用主存中连续的多个字节，每个字节存储一个字符。主存字由 2B 或 4B 组成时，在同一个主存字中，既可按先存储低位字节、后存储高位字节的顺序（即从低位字节向高位字节顺序）存放字符串的内容（又称小端模式），又可按先存储高位字节、后存储低位字节的顺序（即从高位字节向低位字节顺序）存放字符串的内容（又称大端模式）。

这两种存放方式都是常用方式，不同的计算机可以采用其中的任何一种（甚至同时采用）。例如

```matlab
字符串: ABCD EFGH IJKL MNOP ，假设一个主存字大小为 4B，那么
大端：  ABCD EFGH IJKL MNOP   
小端：  DCBA HGFE LKJI PONM 
```

区别主要在字内的字符顺序。

## 5. 校验码

校验码是指能够发现或自动纠正错误的数据编码，也称检错纠错编码。校验码的原理是通过增加一些冗余码，来检验或纠错编码。

通常某种编码都由许多码字构成，任意两个合法码字之间最少变化的二进制位数，称为数据校验码的码距。对于码距不小于 2 的数据校验码，开始具有检错的能力。码距越大，检错、纠错的能力就越强，而且检错能力总是大于等于纠错能力。

奇偶校验码只有一个校验位，码距为 2¹=2，校验位若有 3 个，码距为 2³。

1. 在一个码集中检测 e 个错误，要求最小码距满足：L ≥ e+1
2. 在一个码集中纠正 t 个错误，要求最小码距满足：L ≥ 2t+1
3. 在一种码集中纠正 t 个错误的同时检测 e（e≥t）个错误，要求最小码距满足：L ≥ t+e+1

### 5.1 奇偶检验码

在原编码上加一个校验位，它的码距等于 2，可以检测出一位错误（或奇数位错误），但不能确定出错的位置，也不能够检测出偶数位错误，增加的冗余位称为奇偶校验位。如下

```matlab
奇偶校验码 = 奇偶校验位 + 有效信息位
 n+1 位      1 位        n 位   
```

奇偶校验实现的方法：由若干位有效信息（如 1B）再加上一位二进制位（校验位）组成校验码。校验位的取值（0 或 1）将使整个校验码中 1 的个数为奇数或偶数，所以有两种可供选择的校验规律。

奇校验码：整个校验码（有效信息位和校验位）中 1 的个数位奇数。

偶校验码：整个校验码（有效信息位和校验位）中 1 的个数为偶数。

缺点：具有局限性，奇偶校验只能发现数据代码中奇数位的出错情况，但不能纠正错误，常用于对存储器数据的检查或传输数据的检查。

```markdown
求 1001101 的奇校验码和偶校验码
11001101（奇校验）   01001101（偶校验）
```

### 5.2 海明（汉明）校验码

海明码是广泛采用的一种有效的校验码，它实际上是一种多重奇偶校验码。其实现原理是在有效信息位中加入几个校验位形成海明码，并把海明码的每个二进制位分配到几个奇偶校验组中。当某一位出错后，就会引起有关的几个校验位的值发生变化，这不但可以发现错位，还能指出错位的位置，为自动纠错提供依据。

根据纠错理论得

```markdown
L-1=D+C 且 D≥C
```

即编码最小码距 L 越大，其检测错误的位数 D 越大，纠正错误的位数 C 也越大，且纠错能力恒小于等于检错能力。海明码就是根据这一理论提出的具有纠错能力的一种编码。

```markdown
在 n=4、k=3 时，求 1010 的海明码
1. 首先判断 n+k ≤ 2^k-1
   合理，对应海明码为 H7H6H5H4H3H2H1
2. 确定校验位的分布
   规定校验位 Pi 在海明位号 2^(i-1) 的位置上，得到 101(P3)0(P2)(P1)
3. 分组以形成校验关系
   3 = 2 + 1，H3 分配给 P1 和 P2
   5 = 4 + 1，H5 分配给 P1 和 P3
   6 = 4 + 2，H6 分配给 P2 和 P3
   7 = 4 + 2 + 1，分配给 P1、P2 和 P3
4. 校验位取值
   P1 = H3⊕H5⊕H7
   P2 = H3⊕H6⊕H7
   P3 = H5⊕H6⊕H7
5. 海明码的校验原理
   让 Pi 与 自身异或（如果不出错，相同的数异或为 0）
   S1 = P1⊕H3⊕H5⊕H7 
   S2 = P2⊕H3⊕H6⊕H7
   S3 = P3⊕H5⊕H6⊕H7
   S3S2S1 的值为 000 则代表无错，若为 001 则表示 H1 出错，将对应位取反。
```

### 5.3 循环冗余检验（CRC）码

CRC 的基本思想是：在 K 位信息码后再拼接 R 位的校验码，整个编码的长度为 N 位，因此，这种编码又称 `(N,K)` 码，如下

```matlab
循环冗余校验码 = 信息位 + 校验位
                K位     R位
```

CRC 码基于多线性编码理论，在发送端，将要发送的 K 位二进制信息码左移 R 位，将它与生成多项式 G(x) 做模 2 除法，生成一个 R 位校验码，并附在信息码后，构成一个新的二进制码（CRC 码），共 K+R 位。在接收端，利用生成多项式对接收到的编码做模 2 除法，以检测和确定出错的位置，如无错则整除，其中生成多项式是接收端和发送端的一个约定。

任意一个二进制数码都可用一个系数仅为 1 或 0 的多项式与其对应。生成多项式 G(x) 的最高幂次位 R，转换成对应的多项式为 x³+x²+1 对应的二进制数为 1101，而二进制数 1011 对应的多项式为 x³+x+1 。下面用一个例子来介绍 CRC 的编码和检测过程。（计算的时候根本不用看商对不对，只要余数）

```markdown
设生成多项式为 G(x)=x³+x²+1，信息码为 101001，求对应的 CRC 码。
R=生成多项式最高幂次=3，K=信息码长度=6，N=K+R=9
生成多项式 G(x) 对应的二进制为 1101
1. 移位
   将原信息码左移 R 位，低位补 0，得到 101001000 
2. 相除
   对移位后的信息码，用生成多项式进行模 2 除法，产生余数。
   模 2 除法：模 2 加法和减法的结果相同，都是做异或运算。模 2 除法和算术除法类似，但每位除（减）的
   结果不影响其他位，即不借位，步骤如下
   1. 用除数对被除数最高几位做模 2 减（异或），不借位。
   2. 除数右移一位，若余数最高位为 1，商为 1，并对余数做模 2 减。若余数最高位为 0
      商为 0，除数继续右移一位。
   3. 循环直到余数位数小于除数时，该余数为最终余数。
   模 2 除法得到余数为 001，则报文 101001 编码后的报文（即 CRC 码）为 101001001
3. 检错和纠错
   接收端收到的 CRC 码，用生成多项式 G(x) 做模 2 除法，若余数为 0，则码字无错
   若接收端收到的 CRC 为 101001011，将这个数据与 1101 进行模 2 除法，得到的余数为 010，则
   说明低 2 位出错，将其取反即可。
```

## 6. 习题

1. 校验码的码距必须大于等于几？
2. 1 位奇偶校验能检测出 1 位主存错误的概率？
3. CRC 检测出错误后的措施有？
4. 大量数据传送过程中，常用且有效的校验法是？
5. 全校验是？
6. 有效信息（1100），生成多项式为 1011，求 CRC

## 7. 习题答案

1. 校验码等于 2 时有检错能力，大于 2 后有纠错能力
2. 100%
3. 删除数据、请求重发或自行纠正
4. CRC
5. 自身 = 其他所有数据异或。
6. 1100000%1011 = 010，1100000+010=1100010

