---
title: 4. 指令系统
---

## 1. 小结

1. 什么是指令？什么是指令系统？为什么要引入指令系统？

   指令就是要计算机执行某种操作的命令，一台计算机中所有机器指令的集合，称为这台计算机的指令系统。引入指令系统后，避免了用户与二进制代码直接接触，使得用户编写程序更为方便。另外，指令系统是表征一台计算机性能的重要因素，它的格式与功能不仅直接影响到机器的硬件结构，而且也直接影响到系统软件，影响到机器的适用范围。

2. 一般来说，指令分为哪些部分？每部分有什么用处？

   一条指令通常包括**操作码**字段和**地址码**字段两部分。其中，操作码指出指令中该指令应该执行什么性质的操作和具有何种功能，它是识别指令、了解指令功能与区分操作数地址内容的组成和使用方法等的关键信息。地址码用于给出被操作的信息（指令或数据）的地址，包括参加运算的一个或多个操作数所在的地址、运算结果的保存地址、程序的转移地址、被调用子程序的入口地址等。

3. 对于一个指令系统来说，寻址方式多和少有什么影响？

   寻址方式的多样化能让用户编程更为方便，但多重寻址方式会造成 CPU 结构的复杂化（详见下章），也不利于指令流水线的运行。而寻址方式太少虽然能够提高 CPU 的效率，但对于用户而言，少数几种寻址方式会使编程变得复杂，很难满足用户的需求。

## 2. 查缺补漏

1. 简述各常见指令寻址方式的特点和适用情况。

   立即（数）寻址操作数获取便捷，通常用于给寄存器赋初值。

   直接寻址相对于立即寻址，缩短了指令长度。

   间接寻址扩大了寻址范围，便于编制程序，易于完成子程序返回。

   寄存器寻址的指令字较短，指令执行速度较快。

   寄存器间接寻址扩大了寻址范围。

   基址寻址扩大了操作数寻址范围，适用于多道程序设计，常用于为程序或数据分配存储空间。

   变址寻址主要用于处理数组问题，适合编制循环程序。

   相对寻址用于控制程序的执行顺序、转移等。

   基址寻址和变址寻址的区别：两种方式有效地址的形成都是寄存器内容 + 偏移地址，但是在基址寻址中，程序员操作的是偏移地址，基址寄存器的内容由操作系统控制，在执行过程中是动态调整的；而在变址寻址中，程序员操作的是变址寄存器，偏移地址是固定不变的。

2. 数据（包括指令和操作数）在存储器中可以按 “边界对齐” 和 “边界不对齐” 两种方式存储，这两种方式的区别和优缺点分别是什么？

   设存储字长 32 位，可按字节、半字和字寻址。对于机器字长为 32 位的计算机，数据以对齐方式存放，半字地址一定是 2 的整数倍，字地址一定是 4 的整数倍，这样无论所取的数据是字节、半字还是字，均可一次访存取出。所存備的数据不满足上述要求时，通过填充空白字节使其符合要求。这样虽然浪费了一些存储空间，但可提高取指令和取数的速度。

   数据按不对齐方式存储时，可以充分利用存储空间，但半字长或字长的指令可能会存储在两个存储字中，此时需要两次访存，并且对高低字节的位置进行调整、连接之后才能得到所要的指令或数据，从而影响了指令的执行效率。

   边界对齐方式相对边界不对齐方式是一种空间换时间的思想。RISC 如 ARM 采用边界对齐方式，而 CISC 如 x86 对齐和不对齐都支持。因为对齐方式取指令时间相同，故能适应指令流水。

3. 一个操作数在内存可能占多个单元，怎样在指令中给出操作数的地址？

   现代计算机都采用**字节编址方式**，即一个内存单元只能存放一个字节的信息。一个操作数（如 char、int、  float、 double）可能是 8 位、16 位、32 位或 64 位等，因此可能占用 1 个、2 个、4 个或 8 个内存单元。也就是说，一个操作数可能有多个内存地址对应。

   有两种不同的地址指定方式：大端方式和小端方式。

   大端方式：指令中给出的地址是操作数最高有效字节（MSB）所在的地址。

   小端方式：指令中给出的地址是操作数最低有效字节（LSB）所在的地址。

4. 装入存储（Load/Store）型指令有什么特点？

   装入存储型指令是用在规整型指令系统中的一种通用寄存器型指令风格。这种指令风格在 RISC 指令系统中较为常见。为了规整指令格式，使指令具有相同的长度，规定只有 Load/ Store 指令才能访问内存。而运算指令不能直接访问内存，只能从奇存器取数进行运算，运算的结果也只能送到寄存器。因为寄存器编号较短，而主存地址位数较长，通过某种方式可使运算指令和访存指令的长度一致。

   这种装入存储型风格的指令系统的最大特点是，指令格式规则，指令长度一致，一般为 32 位，由于只有  Load/ Store 指令才能访问内存，程序中可能会包含许多装入指令和存指令，与一般通用寄存器型指令风格相比，其程序长度会更长。

