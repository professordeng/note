---
title: 3.2 存储器的层次化结构
date: 2019-11-12
---

## 1. 多级存储系统

为了解决存储系统大容量、到速度和低成本 3 个相互制约的矛盾，在计算机系统中，通常采用多级存储器结构。如下，从左往右，位价越来越低，速度越来越慢，容量越来越大，CPU 访问的频度也越来越低。

```markdown
CPU → 寄存器 → Cache → 主存 → 磁盘 → 磁带和光盘
```

实际上，存储系统层次结构主要体现在 "Cache→主存" 层次和 “主存→辅存” 层次。前者主要解决 CPU 和主存速度不匹配的问题，后者主要解决存储系统的容量问题。在存储体系中，Cache、主存能与 CPU 直接交换信息，辅存则要通过主存与 CPU 交换信息，主存与 CPU、Cache、辅存都能交换信息。

从 CPU 的角度看，“Cache-主存” 层次速度接近于 Cache，容量和位价却接近于主存。从 “主存-辅存” 层次分析，其速度接近于主存，容量和位价却接近于辅存。这就解决了速度、容量、成本这三者之间的矛盾，现代计算机系统几乎都采用这种三级存储系统。需要注意的是，**主存和 Cache 之间的数据调动是由硬件自动完成的**，对所有程序员均是透明的；而主存和辅存之间的数据调动则是由硬件和操作系统共同完成的，对应用程序员是透明的。

在 “主存-辅存” 这一层次的不断发展中，逐渐形成了虚拟存储系统，在这个系统中程序员编程的地址范围与虚拟存储器的地址空间相对应。对具有虚拟存储器的计算机系统而言，编程时可用的地址空间远大于主存空间。

```markdown
在 "Cache-主存" 和 “主存-辅存” 层次中，上一层中的内容都只是下一层中内容的副本，也即 Cache（主存）中的内容只是主存（辅存）中内容的一部分。
```

## 2. 习题

1. 目的
2. 存储系统包括
3. 命中与不命中关注点
4. Cache/主存系统的效率计算
5. Cache/主存系统平均访问时间

## 3. 习题答案

1. 容量、速度、成本
2. 寄存器、Cache、主存、外存储器
3. 主存与 Cache 是否同时访问
4. 效率 e=访问 Cache 时间/平均访存时间，不要和命中率混淆
5. 总时间/总存取次数=Cache 访存时间/效率 e=命中时间×命中率 + 不命中时间×不命中率（同时访问情况下）