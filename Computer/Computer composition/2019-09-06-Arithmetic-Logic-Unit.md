---
title: 2.4 算术逻辑单元（ALU）
date: 2019-11-09
---

在计算机中，运算器承担了执行各种算术和逻辑运算的工作，运算器由算术逻辑单元（Arithmetic Logic Unit，ALU）、累加器、状态寄存器和通用寄存器等组成。ALU 的基本功能包括加、减、乘、除四则运算，与、或、非、异或等逻辑运算，以及移位、求补等操作。

计算机运行时，运算器的操作和操作种类由控制器决定。运算器处理的数据来自存储器；处理后的结果数据通常送回存储器，或暂存在运算器中。

## 1. 串行加法器

加法器是由全加器再配以其他必要的逻辑电路组成的，根据组成加法器的全加器个数是单个还是多个，加法器有串行和并行之分。

### 1.1 一位全加器

全加器（FA）是最基本的加法单元，有加数 `Ai` 、加数 `Bi` 与低位传来的进位 `C(i-1)` 共三个输入，有本位和 `Si` 与向高位的进位 `Ci` 共两个输出。

全加器的逻辑表达式如下。 

和表达式：`Si=Ai⊕Bi⊕C(i-1)` （`Ai` 、`Bi` 、`C(i-1)` 中有奇数个 1 时，`Si=1` ；否则 `Si=0`）

进位表达式：`Ci=AiBi+(Ai⊕Bi)C(i-1)` 

### 1.2 串行加法器

在串行加法器中，只有一个全加器，数据逐位串行送入加法器中进行运算。若操作数长 n 位，则加法就要分 n 次进行，每次产生一个和，并且串行逐位地送回寄存器。进位触发器用来寄存进位信号，以便参与下一次运算。

串行加法器具有器件少，成本低的优点，但运算速度慢，多用于某些低速的专用运算器。

## 2. 并行加法器

并行加法器由多个全加器组成，其位数与机器的字长相同，各位数据同时运算。并行加法器可同时对数据的各位相加，但存在一个加法的最长运算时间问题，原因是，虽然操作数的各位是同时提供的，但低位运算所产生的进位会影响高位的运算结果。例如，`11...11` 和 `00...01` 相加，最低位产生的进位将逐位影响至最高位，因此并行加法器的最长运算时间主要是由进位信号的传递时间决定的，而每个全加器本身的求和延迟只是次要因素。

因此，提高并行加法器速度的关键是尽量加快进位产生和传递的速度。

并行加法器的进位产生和传递如下：

并行加法器中的每个全加器都有一个从低位送来的进位输入和一个传送给高位的进位输出。通常将传递进位信号的逻辑线路连接起来构成的进位网络称为进位链。

进位表达式为

```matlab
Ci=Gi+PiC(i-1) (Gi=1 或 PiC(i-1)=1 时，Ci=1)
```

式中，`Gi` 是进位产生函数，`Gi=AiBi` ；`Pi` 是进位传递函数，`Pi=Ai⊕Bi` 。

```matlab
当 Ai 和 Bi 都为 1 时，Ci=1，即有进位信号产生，所以将 AiBi 称为进位产生函数或本地进位，并以 Gi 表示。
Ai⊕Bi=1 且 C(i-1) =1 时， Ci=1。这种情况可视为 Ai⊕Bi=1，第 i-1 位的进位信号 C(i-1) 可以通过本
位向高位传送。因此，把 Ai⊕Bi 称为进位传递函数（进位传递条件），并以 Pi 表示
```

并行加法器的进位通常分为串行进位与并行进位。

### 2.1 串行进位

把 n 个全加器串接起来，就可进行两个 n 位数的相加，这种加法器称为串行进位的并行加法器。串行进位又称行波进位，每级进位直接依赖于前一级的进位，即进位信号是逐级形成的。

```matlab
C1 = A1B1 + (A1⊕B1)C0     或 (C1=G1+P1C0)
C2 = A2B2 + (A2⊕B2)C1     或 (C2=G2+P2C1)
...
Cn = AnBn + (An⊕Bn)C(n-1) 或 (Cn=Gn+PnCn)
```

### 2.2 并行进位

并行进位又称先行进位、同时进位，其特点是各级进位信号同时形成。

采用并行进位的方案可以加快进位产生和提高传递的速度，即将各级低位产生的本级 G 和 P 信号依次同时送到高位各全加器的输入，以使它们同时形成进位信号，各进位信号表达式如下，可见它们可以同时形成进位信号。

```matlab
C1 = G1 + P1C0
C2 = G2 + P2C1 = G2 + P2G1 + P2P1C0
C3 = G3 + P3C2 = G3 + P3G2 + P3P2G1 + P3P2P1C0
···
```

上述各式中所有的进位输出仅由 `Gi、Pi` 及最低进位输入 `C0` 决定，而不依赖于其低位的进位输入 `C(i-1)` ，因此各级进位输出可以同时产生。

这种进位方式是快速的，与字长无关。但随着加法器位数的增加，`Ci` 的逻辑表达式会变得越来越长，输入变量会越来越多，这会使电路结构变得很复杂，所以完全采用并行进位是不现实的。

### 2.3 分组并行进位

实际上通常采用分组并行进位方式。这种方式把 n 位全加器分为若干小组，小组内的各位之间实行并行快速进位，小组与小组之间可以采用串行进位方式，也可以采用并行快速进位方式，因此有以下两种情况。

1. 单级先行进位方式，又称组内并行、组间串行进位方式，以 16 位加法器为例，可分为 4 组，每组 4 位。第一组组内的进位逻辑函数 C1、C2、C3、C4 的表达式与前述相同，C1~C4 信号是同时产生的，实现上述进位逻辑函数的电路称为 4 位先行进位电路（CLA）。利用 4 位 CLA 电路、进位产生/传递电路、求和电路可以构成 4 位 CLA 加法器。用 4 个这样的 CLA 加法器可构成 16 位单级先行进位加法器。

2. 多级先行进位方式，又称组内并行、组间并行进位方式。下面仍以 16 位字长的加法器为例，分析两级先行进位加法器的设计方法。第一组的进位输出 C4 可以写为

   ```matlab
   C4 = G4 + P4G3 + P4P3G2 + P4P3P2G1 + P4P3P2P1C0 = G1* + P1*C0
   G1* = G4 + P4G3 + P4P3G2 + P4P3P2G1
   P1* = P4P3P2P1
   ```

   `Gi*` 称为组进位产生函数，`Pi*` 称为组进位传递函数，这两个辅助函数只与 `Pi` 、`Gi` 有关。以此类推，可以得出

   ```matlab
   C8  = G2* + P2*C4 = P2*G1* + P2*P1*C0
   C12 = G3* + P3*G2* + P3*P2*G1* + P3*P2*P1*C0
   C16 = G4* + P4*G3* + P4*P3*G2* + P4*P3*P2*G1* + P4*P3*P2*P1*C0
   ```

   要产生组进位函数，需要对原来的 CLA 电路加以修改：

   第 1 组内产生 `G1*、P1*、C3、C2、C1` ，不产生 C4 。

   第 2 组内产生 `G2*、P2*、C7、C6、C5` ，不产生 C8 。

   第 3 组内产生 `G3*、P3*、C11、C10、C9` ，不产生 C12 。

   第 4 组内产生 `G4*、P4*、C15、C14、C13` ，不产生 C16。

   这种电路称为成组先行进位电路（BCLA）。利用这种 4 位的 BCLA 电路、进位产生/传递电路、求和电路可以构成 4 位 BCLA 加法器。16 位的两级先行加法器由 4 个 BCLA 加法器和 1 个 CLA 电路构成。

   这种方法可以拓展到多于两级的先行进位加法器，如用三级先行进位结构设计 64 位加法器。这种加法器的优点是字长对加法时间影响甚小；缺点是造价较高。

## 3. 算术逻辑单元的功能和结构

ALU 是一种功能较强的组合逻辑电路。它能进行多种算术运算和逻辑运算。由于加、减、乘、除运算最终都能归结为加法运算，因此 ALU 的核心首先应是一个并行加法器，同时也能执行 “与” 、“或” 、“非” 等逻辑运算。

输入变量为 `Ai` 和 `Bi` ，控制信号为 `Ki` ，`Ki` 的不同取值可决定该电路做哪种算术运算或哪种逻辑运算；`Fi` 为输出函数。

最简单的 ALU 是 4 位的。目前，随着集成电路技术的发展，多位的 ALU 已相继问世。（P82）

## 4. 习题

本章非重点，主要关注一些细节即可。

1. ALU 属于？功能包括？
2. 影响加法器运算速度的关键因素？
3. 进位生成信号 g 为？
4. 和表达式？
5. 根据组合方式，加法器类型有？

## 5. 习题答案

1. 组合逻辑电路；算术运算和逻辑运算
2. 进位的快慢
3. `X_iY_i` + `(X_i⊕Y_i)C_(i-1)` （超过两个 1 就进位）
4. `S_i=A_i⊕B_i⊕C_i` （奇数个 1 时 `S_i` 就为 1）
5. 串行、组内并行而组件串行、组内并行且组间串行

