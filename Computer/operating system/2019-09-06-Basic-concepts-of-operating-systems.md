---
title: 1.1 操作系统的基本概念
date: 2019-9-02
---

## 1. 操作系统的基本概念

在信息化时代，软件是计算机系统的灵魂，而作为软件核心的操作系统，已与现代计算机系统密不可分、融为一体。计算机系统自下而上可大致分为四部分：硬件、操作系统、应用程序和用户（这里的划分与计算机组成原理的分层不同）。操作系统管理各种计算机硬件，为应用程序提供基础，并充当计算机硬件与用户之间的中介。

硬件如中央处理器、内存、输入输出设备等，提供基本的计算资源。应用程序如字处理程序、电子制表软件、编译器、网络浏览器等，规定按何种方式使用这些资源来解决用户的计算问题。操作系统控制和协调各用户的应用程序对硬件的分配与使用。

在计算机系统的运行过程中，操作系统提供了正确使用这些资源的方法。

综上所述，操作系统（Operating System，OS）是指控制和管理整个计算机系统的硬件与软件资源，合理地组织、调度计算机的工作与资源的分配，进而为用户和其他软件提供方便接口与环境的程序集合。计算机操作系统是随着计算机研究和应用的发展逐步形成并发展起来的，它是计算机系统中最基本的系统软件。

## 2. 操作系统的特征

操作系统是一种系统软件，但与其他系统软件和应用软件有很大的不同，它有自己的特殊性即基本特征。操作系统的基本特征包括并发、共享、虚拟和异步。这些概念对理解和掌握操作系统的核心至关重要，将一直贯穿于各个章节中。

### 2.1 并发（Concurrence）

并发是指两个或多个事件在同一时间间隔内发生。操作系统的并发性是指计算机系统中同时存在多个运行的程序，因此它具有处理和调度多个程序同时执行的能力。在操作系统中，引入进程的目的是使程序能并发执行。

注意同一时间间隔（并发）和同一时刻（并行）的区别。在多道程序环境下，一段时间内宏观上有多道程序在同时执行，而在每个时刻，单处理机环境下实际仅能有一道程序执行，因此微观上这些程序仍是分时交替执行的。操作系统的并发性是通过分时得以实现的。

注意，并行性是指系统具有同时进行运算或操作的特性，在同一时刻能完成两种或两种以上的工作。并行性需要有相关硬件的支持，如多流水线或多处理机硬件环境。

我们以现实生活中的直观例子来认识并发和并行的区别。例如，如果你在 9:00~9:10 仅吃面包，在 9:10~9:20 仅写字，在 9:20~9:30 仅吃面包，在 9:30~10:00 仅写字，那么在 9:00~10:00 吃面包和写字这两种行为就是并发执行的；再如，如果你在 9:00~10:00 右手写字，左手同时拿着面包吃，那么这两个动作就是并行执行的。

### 2.2 共享（sharing）

资源共享即共享，是指系统中的资源可供内存中多个并发执行的进程共同使用。共享可分为以下两种资源共享方式。

1. 互斥共享方式

   系统中的某些资源，如打印机、磁带机，虽然可供多个进程使用，但为使得所打印或记录的结果不致造成混淆，应规定在一段时间内只允许一个进程访问该资源。

   为此，当进程 A 访问某个资源时，必须先提出请求，若此时该资源空闲，则系统便将之分配给进程 A 使用，此后有其他进程也要访问该资源时（只要 A 未用完）就必须等待。仅当进程 A 访问完并释放该资源后，才允许另一个进程对该资源进行访问。我们把这种资源共享方式称为互斥式共享，而把在一段时间内只允许一个进程访问的资源称为临界资源或独占资源。计算机系统中的大多数物理设备及某些软件中所用的栈、变量和表格，都属于临界资源，它们都要求被互斥地共享。

2. 同时访问方式

   系统中还有另一类资源，这类资源允许在一段时间内由多个进程 “同时” 访问。这里所说的 “同时” 通常是宏观上的，而在微观上，这些进程可能是交替地对该资源进行访问即 “分时共享” 的。可供多个进程 “同时” 访问的典型资源是磁盘设备，一些用重入码编写的文件也可被 “同时” 共享，即允许若干个用户同时访问该文件。

注意，互斥共享要求一种资源在一段时间内（哪怕是一段很小的时间）只能满足一个请求，否则就会出现严重的间题，（你能想象打印机第一行打印 A 文档的内容、第二行打印 B 文档的内容的效果吗？）而同时访问共享通常要求一个请求分几个时间片段间隔地完成，其效果与连续完成的效果相同。

并发和共享是操作系统两个最基本的特征，两者之间互为存在的条件：

1. 资源共享是以程序的并发为条件的，若系统不允许程序并发执行，则自然不存在资源共享问题。
2. 若系统不能对资源共享实施有效的管理，则必将影响到程序的并发执行，甚至根本无法并发执行。

### 2.3 虚拟（Virtual）

虚拟是指把一个物理上的实体变为若干逻辑上的对应物。物理实体（前者）是实的，即实际存在的；而后者是虚的，是用户感觉上的事物。用于实现虚拟的技术，称为虚拟技术。操作系统中利用了多种虚拟技术来实现虚拟处理器、虚拟内存和虚拟外部设备等。

虚拟处理器技术是通过多道程序设计技术，采用让多道程序并发执行的方法，来分时使用个处理器的。此时，虽然只有一个处理器，但它能同时为多个用户服务，使每个终端用户都感觉有一个中央处理器（CPU）在专门为它服务。利用多道程序设计技术把一个物理上的 CPU 虚拟为多个逻辑上的 CPU，称为虚拟处理器。

类似地，可以采用虚拟存储器技术将一台机器的物理存储器变为虚拟存储器，以便从逻辑上扩充存储器的容量。当然，这时用户所感觉到的内存容量是虚的。我们把用户感觉到（但实际不存在）的存储器称为虚拟存储器。

还可采用虚拟设备技术将一台物理 IO 设备虚拟为多台逻辑上的 IO 设备，并允许每个用户占用一台逻辑上的 IO 设备，使原来仅允许在一段时间内由一个用户访问的设备（即临界资源）变为在一段时间内允许多个用户同时访问的共享设备（假脱机）。

因此，操作系统的虚拟技术可归纳为：时分复用技术，如处理器的分时共享；空分复用技术，如虚拟存储器。

### 2.4 异步（Asynchronism）

多道程序环境允许多个程序并发执行，但由于资源有限，进程的执行并不是一贯到底的，而是走走停停的，它以不可预知的速度向前推进，这就是进程的异步性。

异步性使得操作系统运行在一种随机的环境下，可能导致进程产生与时间有关的错误（就像对全局变量的访问顺序不当会导致程序出错一样）。然而，只要运行环境相同，操作系统就须保证多次运行进程后都能获得相同的结果。

## 3. 操作系统的目标和功能

为了给多道程序提供良好的运行环境，操作系统应具有以下几方面的功能：处理机管理、存储器管理、设备管理和文件管理。为了方便用户使用操作系统，还必须向用户提供接口。同时，操作系统可用来扩充机器，以提供更方便的服务、更高的资源利用率。

我们用一个直观的例子来理解这种情況。例如，用户是雇主，操作系统是工人（用来操作机器），计算机是机器（由处理机、存储器、设备、文件几个部件构成），工人有熟练的技能，能够控制和协调各个部件的工作，这就是操作系统对资源的管理；同时，工人必须接收雇主的命令，这就是 “接口”；有了工人，机器就能发挥更大的作用，因此工人就成了 “扩充机器”。

### 3.1 操作系统作为计算机系统资源的管理者

1. 处理机管理

   在多道程序环境下，处理机的分配和运行都以进程（或线程）为基本单位，因而对处理机管理可归结为对进程的管理。并发是指在计算机内同时运行多个进程，因此进程何时创建、何时撤销、如何管理、如何避免冲突、合理共享就是进程管理的最主要的任务。进程管理的主要功包括进程控制、进程同步、进程通信、死锁处理、处理机调度等。

2. 储存器管理

   存储器管理是为了给多道程序的运行提供良好的环境，方便用户使用及提高内存的利用率，主要包括内存分配、地址映射、内存保护与共享和内存扩充等功能。

3. 文件管理

   计算机中的信息都是以文件的形式存在的，操作系统中负责文件管理的部分称为文件系统。文件管理包括文件存储空间的管理、目录管理及文件读写管理和保护等。

4. 设备管理

   设备管理的主要任务是完成用户的 IO 请求，方便用户使用各种设备，并提高设备的利用率，主要包括缓冲管理、设备分配、设备处理和虚拟设备等功能。

这些工作都由 “工人” 负责，“雇主” 无须关注。

### 3.2 操作系统作为用户与计算机硬件系统之间的接口

为方便用户使用计算机，操作系统还提供了用户接口。操作系统提供的接口主要分为两类：一类是命令接口，用户利用这些操作命令来组织和控制作业的执行；另一类是程序接口，编程人员可以使用它们来请求操作系统服务。

1. 命令接口

   使用命令接口进行作业控制的主要方式有两种，即联机控制方式和脱机控制方式。按作业控制方式的不同，可将命令接口分为联机命令接口和脱机命令接口。

   联机命令接口又称交互式命令接口，适用于分时或实时系统的接口。它由一组键盘操作命令组成。用户通过控制台或终端输入操作命令，向系统提出各种服务要求。用户每输入一条命令，控制权就转给操作系统的命令解释程序，然后由命令解释程序解释并执行输入的命令，完成指定的功能。之后，控制权转回控制台或终端，此时用户又可输入下一条命令。

   脱机命令接口又称批处理命令接口，适用于批处理系统，它由一组作业控制命令（或作业控制语句）组成。脱机用户不能直接干预作业的运行，而应事先用相应的作业控制命令写成一份作业操作说明书，连同作业一起提交给系统。系统调度到该作业时，由系统中的命令解释程序逐条解释执行作业说明书上的命令或作业控制语句，从而间接地控制作业的运行。

   联机命令接口可以这样理解：“雇主” 说一句话，“工人” 做一件事，并做出反馈，这就强调了交互性。

   脱机命令接口可以这样理解：“雇主” 把要 “工人” 做的事写在清单上，“工人” 按照清单命令逐条完成这些事。这就是批处理。

2. 程序接口

   程序接口由一组系统调用命令（简称系统调用，也称广义指令）组成。用户通过在程序中使用这些系统调用命令来请求操作系统为其提供服务。用户在程序中可以直接使用这组系统调用命令向系统提出各种服务要求，如使用各种外部设备、进行有关磁盘文件的操作、申请分配和回收内存及其他各种控制要求。

   当前最为流行的是图形用户界面（GUI），即图形接口，用户通过鼠标和键盘，在图形界面上单击或使用快捷键，就能很方便地使用操作系统。有些系统提供了上述三种接口，但 GUI 最终是通过调用程序接口实现的。严格地说，GUI 图形接口不是操作系统的一部分，但图形接口所调用的系统调用命令是操作系统的一部分。

### 3.3 操作系统用作扩充机器

没有任何软件支持的计算机称为裸机，它仅构成计算机系统的物质基础，而实际呈现在用户面前的计算机系统是经过若干层软件改造的计算机。裸机在最里层，其外面是操作系统。操作系统所提供的资源管理功能和方便用户的各种服务功能，将裸机改造成功能更强、使用更方便的机器；因此，我们通常把覆盖了软件的机器称为扩充机器或虚拟机。

“工人” 操作机器，机器就有更大的作用，于是 “工人” 便成了 “扩充机器”。

注意，本课程所关注的内容是操作系统如何控制和协调处理机、存储器、设备和文件，而不关注接口和扩充机器，后两者读者只需要有个印象，能理解即可。

## 4. 习题

1. 操作系统是什么？

2. 操作系统是对什么进行管理的软件？

3. 操作系统的基本功能？

4. 现代操作系统中最基本的两个特征是啥？

5. 说说你对并发的理解。

6. 单处理机系统中，同一时刻最多有几个进程同时运行？

7. 用户可以通过哪些方式使用计算机？

8. 系统调用怎么用？

9. 操作系统提供给应用程序的接口是什么？

10. 操作系统提供给编程人员的接口是什么？

11. 系统调用的目的是？

12. 命令接口可进一步分为什么？

13. 用户在程序中试图读某个文件的第 100 个逻辑块，使用操作系统提供的什么接口？

14. 操作系统与用户通信接口通常不包括

    A：shell B：命令解释器 C：广义指令 D：缓存管理指令

15. 不属于多道设计程序的基本特征是

    A：制约性 B：间断性 C：顺序性 D：共享性

16. 综合题：库函数和系统调用的区别和联系。

## 5. 习题答案

1. 系统软件
2. 计算机资源，包括硬件资源和软件资源，注意，文件不属于硬件资源，但属于软件资源。
3. 四大管理功能
4. 并发和共享
5. 一个时间段有多个进程运行
6. 一个
7. 命令接口和系统调用
8. 编程的时候用
9. 系统调用
10. 系统调用
11. 请求系统服务
12. 联机命令和脱机命令
13. 系统调用
14. D，缓存管理对用户透明
15. C，异步性才对
16. 库函数是语言或应用程序的一部分，可以运行在用户空间中。而系统调用是操作系统的一部分，是内核为用户提供的程序接口，运行在内核空间中，而且许多库函数都会使用系统调用来实现功能。未使用系统调用的库函数，其执行效率通常要比系统调用的高。因为使用系统调用时，需要上下文的切换及状态的切换（由用户态转向和心态）。