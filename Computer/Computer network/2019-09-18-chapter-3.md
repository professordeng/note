---
title: 3. 数据链路层
date: 2019-11-06
---

## 本章小结

1. “链路” 和 “数据链路” 有何区别？“电路接通” 与 “数据链路接通” 有何区别？

   所谓链路（Link），是指从一个结点到相邻结点的一段物理线路，其中间没有其他任何的交换结点。在进行数据通信时，两台计算机之间的通信路径往往要经过许多段这样的链路。可见，链路只是一条路径的组成部分。

   数据链路（Data Link）则是另一个概念。要在一条线路上传送数据，除必须要有一条物理线路外，还必须有一些通信协议来控制这些数据的传输。若把实现这些协议的硬件和软件加到链路上，就构成了数据链路。有时也把链路分为物理链路和逻辑链路。物理链路就是指上面所谓的链路，逻辑链路就是上面所谓的数据链路。

   “电路接通” 表示链路两端的结点交换机已经开机，物理连接已经能够传送比特流，但数据传输并不可靠，在物理连接基础上,再建立数据链路连接，才能说 “数据链路接通”。此后，由于数据链路连接具有检测、确认和重传功能，才使得不太可靠的物理链路变成可靠的数据链路，进行可靠的数据传输。当数据链路断开连接时，物理电路连接不一定跟着断开连接。

2. 在停止-等待协议中，确认桢为什么不需要序号（如用 ACK0 和 ACK1）？

   在停止-等待协议中，发送方毎发送一帧，都需要在收到接收方的确认帧后，才能进行下一帧的发送，而发送方收到的确认帧也一定是自己刚刚发出去的数据帧的确认帧，无须加序号标记。

3. 说明用 n 比特进行编号时，若接收窗口的大小为 1，则只有在发送窗ロ的大小 WT≤2^n-1 时，连续 ARQ 协议才能正确运行。

   举一个具体的例子进行说明。例如用 3 比特可编出 8 个不同的序号，因而发送窗口的最大值似乎应为8。但实际上，设置发送窗口为 8 将使协议在某些情况下无法工作。现在我们就来说明这一点。

   设发送窗口 WT=8，发送端发送完 0~7 号共 8 个数据帧。因发送窗口已满，发送暂停。假定这 8 个数据帧均己正确到达接收端，并且对每个数据帧，接收端都发送出确认帧。下面考虑两种不同的情况。

   第一种情况是：所有确认帧都正确到达了发送端，因而发送端接着又发送 8 个新的数据，其编号应是 0~7。注意，序号是循环使用的。因此序号虽然相同，但 8 个帧都是新的帧。

   第二种情况是：所有确认帧都丢失了。经过一段由超时计时器控制的时间后，发送端重传这 8个旧的数据帧，其编号仍为 0~7。

   于是，当接收端第二次收到编号为 0~7 的 8 个数据帧时，就无法判定这是 8 个新的数据还是 8 个重传的旧数据帧。

   因此，将发送窗口设置为 8 显然是不行的。

4. 证明：对于选择重传协议，若有 n 比特进行编号，则接收窗口的最大值为 WR≤2^(n-1)。

   设发送窗口大小为 WT。因为 WT+WR≤2^n，WT=WR，取最大值 2^n/2=2^(n-1)。

   注意，如果题目没有特别说明，那么一般情况下选择重传协议的发送窗口和接收窗口的大小是相等的。大家试想一下，SR 协议中接收窗口值大于 1，接收窗口要等到接收范围内所有帧收到才能更新，发送窗口要等接收窗口更新后才会更新，那么发送窗口比接收窗口多出来的那部分窗口就没有意义了。

5. 数据链路层使用 PPP 协议或 CSMA/CD 协议时，既然不保证可靠传输，为什么要对所传输的帧进行差错检验？

   当数据链路层使用 PPP 协议或 CSMA/CD 协议时，在数据链路层的接收端对所传输的帧进行差错检验是为了不将已发现有差错的帧（不管是什么原因造成的）接收下来。如果在接收端不进行差错检测，那么接收端上交给主机的帧就可能包括在传输中出了差错的帧，而这样的帧对接收端主机是没有用处的。换言之，接收端进行差错检测的目的是：“上交主机的帧都是没有传输差错的，有差错的都已经丢弃了”，或者更加严格地说：“我们以很接近于 1 的概率认为，凡是上交主机的帧都是没有传输差错的”。

6. 为什么 PPP 协议不使用帧的编号和确认机制来实现可靠传输？

   PPP 不使用序号和确认机制是出于以下考虑：

   若使用能够实现可靠传输的数据链路层协议（如 HDLC），开销就会增大。当数据链路层出现差错的概率不大时，使用比较简单的 PPP 较为合理。

   在因特网环境下，PPP 的信息字段放入的数据是 IP 数据报。假定我们采用了能实现可靠传输但十分复杂的数据链路层协议，当数据帧在路由器中从数据链路层上升到网络层后，仍有可能因网络拥塞而被丢弃。因此，数据链路层的可靠传输并不能保证网络层的传输也是可靠的。

   PPP 在帧格式中有帧校验序列 FCS 字段。对于每个收到的帧，PPP 都要使用硬件进行 CRC 检验。若发现有差错，则丢弃该帧（一定不能把有差错的帧交给上一层）。端到端的差错控制最后由高层协议负责。因此，PPP可以保证无差错接收。

7. 两台计算机通过计算机网络传输一个文件时，有两种可行的确认策略，第一种是由发送端将文件分割成分组，接收端逐个地确认分组；但就整体而言，文件并没有得到确认。第二种策略是接收端不确认单个分组，而是当文件全部收到后，对整个文件予以接收认。试比较这两种方式的优缺点，以及它们各自适用的场合。

   在计算机网络中，数据的传输过程可能会引起数据的丢失、出错等，因此一个可靠的传输需要一定的差错控制机制，确认是实现差错控制的一个辅助手段。上面的两种确认策略都是可行的，但它们的性能取决于所应用的网络环境。

   具体地说，当网络传输可靠性较低且分组容易丢失时，第一种策略即对每个分组逐一确认较好，此时仅需重传丢失或出错的分组。如果网络的传输可靠性较高，那么在不发生差错的情况下，仅对整个文件进行一次确认，从而減少了确认的次数，节省了网络带宽和网络资源；不过，即使有单个分组丢失或出错，也需要重传整个文件。

8. .局域网、广域网和因特网之间的关系总结。

   为方便理解，可将广域网视为一个大的局域网，专业地讲，就是通过交换机连接多个局域网，组成更大的局域网，即广域网。因此，广域网仍然是一个网络。而因特网是多个网络之间的互联，即因特网由大局域网（广域网）和小局域网共同通过路由器相连。因此局域网可以通过广域网与另一个相隔很远的局域网进行通信。

9. IEEE 802 局域网参考模型与 OSI 参考模型有何异同之处？

   局域网的体系结构只有 OSI 的下两层（物理层和数据链路层），而没有第三层以上的层次。即使是下两层，由于局域网是共享广播信道，而且产品的种类繁多，涉及多种媒体访问方法，所以两者存在明显的差别。

   在局域网中，与 OSI 参考模型的物理层相同的是：该层负责物理连接并在媒体上传输比特流主要任务是描述传输媒体接口的一些特性。在局域网中，数据链路层的主要作用与 OSI 参考模型的数据链路层相同：都通过一些数据链路层协议，在不可靠的传输信道上实现可靠的数据传输；负责帧的传送与控制，但在局域网中，由于各站共享网络公共信道，因此数据链路层必须具有媒体访问控制功能（如何分配信道、如何避免或解决信道争用）。又由于局域网采用的拓扑结构与传输媒体多种多样，相应的媒体访问控制方法也有多种，因此在数据链路功能中应该将与传输媒体有关的部分和无关的部分分开。这样，IEEE 802 局域网参考模型中的数据链路层就划分为两个子层：媒体访问控制（MAC）子层和逻辑链路控制（LLC）子层。

   与 OSI 参考模型不同的是：在 IEEE 802 局域网参考模型中没有网络层。局域网中，在任意两个结点之间只有唯一的一条链路，不需要进行路由选择和流量控制，所以在局域网中不单独设置网络层。

   由上面的分析可知，局域网的参考模型只相当于 OSI 参考模型的最低两层，且两者的物理层和数据链路层之间也有很大差别。在 IEEE 802 系列标准中，各个子标准的物理层和媒体访问控制（MAC）子层是有区别的，而逻辑链路控制（LLC）子层是相同的，也就是说，LLC 子层实际上是高层协议与任何一种 MAC 子层之间的标准接口。

10. 在 IEEE 802.3 标准以太网中，为什么说如果有冲突，那么冲突一定发生在冲突窗口内？或者说一个帧如果在冲突窗口内没有发生冲突，那么该帧就不会再发生冲突？

    结点发送数据时，先侦听信道是否有载波，如果有，表示信道忙，那么继续侦听，直至检测到空闲为止；一个数据帧在从结点 A 向最远的结点传输的过程中，如果有其他结点也正在发送数据，那么此时就会发生冲突，冲突后的信号需要经过冲突窗口时间后传回结点 A，结点 A 会检测到冲突，所以说如果有冲突，那么一定发生在冲突窗口内，如果在冲突窗口内没有发生冲突，之后如果其他结点再要发送数据，那么就会侦听到信道忙，而不会发送数据，从而不会再发生冲突。

11. 一个以太网的速率从 10Mb/s 升级到 100Mb/s，满足 CSMA/CD 冲突条件。为使其正常工作，需做哪些调整？为什么？

    由于 10BASE-T 要比 10BASE2 和 10BASE5 的优越性更明显，因此所有快速以太网系统都使用集线器（Hub），而不使用同轴电缆。100BASE-T MAC 与 10Mb/s 的经典以太网 MAC 几乎一样，唯一不同的参数就是帧际间隙时间，10Mb/s 以太网是 9.6μs（最小值），快速以太网（100Mb/s）是 0.96μs（最小值）。另外，为了维持最小分组尺寸不变，需要减小最大冲突域直径。所有这些调整的主要原因是速率提高到了原来以太网的 10 倍。

12. HDLC 协议是 PPP 协议的基础，它使用位填充来实现透明传输、但 PPP 协议却使用字待填充而不使用位填充，为什么？

    PPP 被明确地设计成以软件形式实现，而不像 HDLC 协议那样几乎总以硬件形式实现，对于软件实现，完全用字节操作比用单个位操作简单得多。此外，PPP 被设计成与调制解调器一道使用，而调制解调器是以一个字节而非一个比特为单元接收和发送数据的。

13. 假定连接到透明网桥上的一台计算机把一个数据发给网络上的一个不存在的设备，网桥将如何处理这个帧？

    网桥不知道网络上是否存在该设备，它只知道在其转发表中没有这个设备的 MAC 地址。因此，当网桥收到这个目的地址未知的帧时，它将扩散该帧，即把该帧发送到所连接的除输入网段外的所有其他网段。（生成树算法保证了无环）

14. 关于冲突域（碰撞域）和广播域辨析。

    一块网卡发送信息时，只要有可能和另一块网卡冲突，那么这些可能冲突的网卡就构成冲突域。一块网卡发出一个广播时，能收到这个广播的所有网卡的集合称为ー个广播域。一般来说，一个网段就是一个冲突域，一个局域网就是一个广播域。

15. 关于物理层、数据链路层、网络层设备对于隔离冲突域和广播域的总结。

    | 设备名称 | 能否隔离冲突域 | 能否隔离广播域 |
    | -------- | -------------- | -------------- |
    | 集线器   | 不能           | 不能           |
    | 中继器   | 不能           | 不能           |
    | 交换机   | 能             | 不能           |
    | 网桥     | 能             | 不能           |
    | 路由器   | 能             | 能             |

16. 与传统共享式局域网相比，使用局域网交换机的交接式局域网为什么能改善网络的性能和服务质量？

    传统共享式局域网的核心设备是集线器，而交交换局域网的核心是以太网交换机。在使用共享式集线器的传统局域网中，在任何时刻只能有一个结点能够通过共享通信信道发送数据；在使用交换机的交换式局域网中，交换机可以在它的多个端口之间建立多个并发连接，从而实现结点之间数据的并发传输，有效地改善网络性能和服务质量。

17. 试分析中继器、集线器、网桥和交换机这四种网络互联设备的区别与联系。

    这四种设备都是用于互联、扩展局域网的连接设备，但它们工作的层次和实现的功能不同。

    中继器工作在物理层，用来连接两个速率相同且数据链路层协议也相同的网段，其功能是消除数字信号在基带传输中由于经过一长段电缆而造成的失真和衰减，使信号的波形和强度达到所需的要求；其原理是信号再生。

    集线器（Hub）也工作在物理层，相当于一个多接口的中继器，它可将多个结点连接成一个共享式的局域网，但任何时刻都只能有一个结点通过公共信道发送数据。

    网桥工作在数据链路层，可以互联不同的物理层、不同的 MAC 子层及不同速率的以太网。网桥具有过滤帧及存储转发帧的功能，可以隔离冲突域，但不能隔离广播域。

    交换机工作在数据链路层，相当于一个多端口的网桥，是交换式局域网的核心设备。它允许端口之间建立多个并发连接，实现多个结点之间的并发传输。因此，交换机的每个端口结点所占用的带宽不会因为端口结点数目的増加而减少，且整个交换机的总带宽会随着端口结点的增加而增加。交换机一般工作在全双工方式，有的局域网交换机采用存储转发方式进行转发，也有的交换机采用直通交换方式（即在收到帧的同时立即按帧的目的 MAC 地址决定该帧的转发端口，而不必先缓存再处理）。另外，利用交换机可以实现虚拟局域网（VLAN），VLAN 不仅可以隔离冲突域，而且可以隔离广播域。

18. 交换机和网桥的不同之处。

    尽管交换机也称多端口网桥，但两者仍有许多不同之处。主要包括以下 3 点：

    1. 网桥的端口一般连接局域网，而交换机的端口一般直接与局域网的主机相连。
    2. 交换机允许多对计算机同时通信，而网桥仅允许每个网段上的计算机同时通信。
    3. 网桥采用存储转发进行转发，而以太网交换机还可以采用直通方式进行转发，且以太网交换机采用了专用的交换结构芯片，转发速度比网桥快。